<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BG Music</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <style>
        .myCanvas{
            border:1px dashed red;
        }
    </style>
  </head>
  <body>
    <canvas class="myCanvas" width="400" height="400"></canvas>

    <script>
      // Get the canvas element
      // Set the initial position of the rectangle
      console.log('Random',Math.ceil(Math.random(0,1)*1200))
      var xx =Math.ceil(Math.random(0,1)*1200);;
      var yy = -160;

      // Set the animation speed
      var speed = 2;
      let canvas = document.querySelector(".myCanvas");
            
      canvas.width = window.innerWidth-20;
      canvas.height = window.innerHeight-20;
      console.log('*',window.innerHeight-20);
      console.log('*',(window.innerHeight-20)*0.8);
      let ch80 = (window.innerHeight-20)*0.8;
      var ctx = canvas.getContext("2d");
      

      function draw() {
        // Clear the canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw the rectangle
        ctx.fillStyle = "red"; // Set the fill color
        ctx.fillRect(xx, yy, 150, 150); // Draw the rectangle (x, y, width, height)

        // Update the position of the rectangle
        if(yy <= (ch80-150)){
          yy+= speed;
          
          console.log(yy);
          // Request the next animation frame
          requestAnimationFrame(draw);
        }
       
       
      }

      // Start the animation
      draw();

      // Define explosion properties
      var particles = [];
      var particleCount = 100;
      var particleSize = 3;
      var explosionStrength = 7;

      // Initialize explosion
      function explode(x, y) {
        for (var i = 0; i < particleCount; i++) {
          var angle = Math.random() * 2 * Math.PI;
          var speed = Math.random() * explosionStrength;
          var particle = {
            x: x,
            y: y,
            xVelocity: Math.cos(angle) * speed,
            yVelocity: Math.sin(angle) * speed,
          };
          particles.push(particle);
        }
      }

      // Update particle positions and draw explosion
      function drawExplosion() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (var i = 0; i < particles.length; i++) {
          var particle = particles[i];

          // Update position
          particle.x += particle.xVelocity;
          particle.y += particle.yVelocity;

          // Apply gravity
          particle.yVelocity += 0.1;

          // Draw particle
          ctx.fillRect(
            particle.x - particleSize / 2,
            particle.y - particleSize / 2,
            particleSize,
            particleSize
          );
        }

        // Remove particles that have gone off-screen
        particles = particles.filter(function (particle) {
          return (
            particle.x >= 0 &&
            particle.x <= canvas.width &&
            particle.y >= 0 &&
            particle.y <= canvas.height
          );
        });

        // Request the next animation frame
        if (particles.length > 0) {
          requestAnimationFrame(drawExplosion);
        }
      }

      // Handle key press event
      //object.method(arg1,arg2);
      //arg1 = String
      //arg2 = cbfn callback funciton
      document.addEventListener("keypress", function (event) {
        var key = String.fromCharCode(event.keyCode);
        console.log("Key pressed:", key);

        // Play explosion animation
        var x = Math.random() * canvas.width;
        var y = Math.random() * canvas.height;
        console.log('yy->',yy);
        explode(xx+75, yy+75);

        //2. Function calling
        drawExplosion();
      });
    </script>
  </body>
</html>
